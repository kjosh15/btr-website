---
import { getEntryBySlug } from 'astro:content';

import BaseLayout from '../../layouts/BaseLayout.astro';
import Hero from '../../components/Hero.astro';
import Section from '../../components/Section.astro';
import CtaGroup from '../../components/CtaGroup.astro';
import LogoCarousel from '../../components/LogoCarousel.astro';
import ContactForm from '../../components/ContactForm.astro';
import StatsGrid from '../../components/StatsGrid.astro';
import StepsTimeline from '../../components/StepsTimeline.astro';
import CaseGrid from '../../components/CaseGrid.astro';
import OfferingsColumns from '../../components/OfferingsColumns.astro';
import EngageCards from '../../components/EngageCards.astro';
import locale from '../../locales/is.json';

const hero = await getEntryBySlug('is', 'hero');
const why = await getEntryBySlug('is', 'why');
const process = await getEntryBySlug('is', 'process');
const proof = await getEntryBySlug('is', 'proof');
const offerings = await getEntryBySlug('is', 'offerings');
const about = await getEntryBySlug('is', 'about');
const engage = await getEntryBySlug('is', 'final-cta');

const { Content: WhyContent } = await why.render();
const { Content: ProcessContent } = await process.render();
const { Content: ProofContent } = await proof.render();
const { Content: OfferingsContent } = await offerings.render();
const { Content: AboutContent } = await about.render();
const { Content: EngageContent } = await engage.render();

const navItems = locale.nav;
const alternate = { lang: 'en', href: '../' };
const partnerLogos = [
  { name: 'OpenAI', file: 'openai.svg' },
  { name: 'Anthropic', file: 'anthropic.svg' },
  { name: 'Google Cloud', file: 'google-cloud.svg' },
  { name: 'AWS', file: 'aws.svg' },
  { name: 'NVIDIA', file: 'nvidia.svg' },
  { name: 'Microsoft', file: 'microsoft.png' },
];
---
<BaseLayout lang="is" locale={locale} navItems={navItems} alternate={alternate} meta={locale.meta}>
  <Hero data={hero.data} />

  <Section
    id={why.data.section}
    eyebrow={why.data.eyebrow}
    heading={why.data.heading}
    background="muted"
  >
    {why.data.stats && <StatsGrid stats={why.data.stats} />}
    <div class="mt-8 space-y-6">
      <WhyContent />
      {(why.data.calloutTitle || why.data.calloutBody) && (
        <blockquote class="rounded-2xl border border-btr-accent/20 bg-white/90 p-6 text-base font-medium text-btr-text/85">
          {why.data.calloutTitle && (
            <span class="block text-xs font-semibold uppercase tracking-[0.3em] text-btr-accent">
              {why.data.calloutTitle}
            </span>
          )}
          {why.data.calloutBody}
        </blockquote>
      )}
    </div>
  </Section>

  <Section
    id={process.data.section}
    eyebrow={process.data.eyebrow}
    heading={process.data.heading}
  >
    <div class="grid gap-10 lg:grid-cols-[minmax(0,1fr)_minmax(0,1.1fr)] lg:items-start">
      <div class="space-y-6">
        <ProcessContent />
        {process.data.quote && (
          <blockquote class="rounded-3xl border border-btr-accent/15 bg-btr-muted/40 p-6 text-base font-medium text-btr-text/80">
            “{process.data.quote}”
          </blockquote>
        )}
      </div>
      {process.data.steps && <StepsTimeline steps={process.data.steps} />}
    </div>
  </Section>

  <Section
    id={proof.data.section}
    eyebrow={proof.data.eyebrow}
    heading={proof.data.heading}
    background="muted"
  >
    <div class="grid gap-8 lg:grid-cols-[minmax(0,1.1fr)_minmax(0,1fr)] lg:items-start">
      <ProofContent />
      {proof.data.cases && <CaseGrid cases={proof.data.cases} />}
    </div>
    {proof.data.cta && (
      <div class="mt-8">
        <CtaGroup ctas={[proof.data.cta]} />
      </div>
    )}
  </Section>

  <Section
    id="partners"
    eyebrow="[TODO] Samstarfsaðilar"
    heading="[TODO] Vinnum með helstu AI vettvöngum"
  >
    <p class="text-btr-text/75">[TODO] Bæta við íslenskum texta um samstarf við OpenAI, Anthropic, Google, AWS og NVIDIA.</p>
    <div class="mt-8"><LogoCarousel logos={partnerLogos} /></div>
  </Section>

  <Section
    id={offerings.data.section}
    eyebrow={offerings.data.eyebrow}
    heading={offerings.data.heading}
  >
    <OfferingsContent />
    {offerings.data.audiences && (
      <div class="mt-10">
        <OfferingsColumns audiences={offerings.data.audiences} />
      </div>
    )}
  </Section>

  <Section
    id={about.data.section}
    eyebrow={about.data.eyebrow}
    heading={about.data.heading}
  >
    <AboutContent />
    {about.data.logos && (
      <div class="mt-10 rounded-3xl border border-btr-muted bg-btr-muted/50 p-6">
        <LogoCarousel logos={about.data.logos} />
      </div>
    )}
  </Section>

  <Section
    id={engage.data.section}
    eyebrow={engage.data.eyebrow}
    heading={engage.data.heading}
    background="muted"
  >
    <EngageContent />
    {engage.data.actions && (
      <div class="mt-8">
        <EngageCards actions={engage.data.actions} />
      </div>
    )}
  </Section>

  <ContactForm id="connect" form={locale.forms.combined} />
</BaseLayout>
